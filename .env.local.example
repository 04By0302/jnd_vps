# 本地开发环境配置
# 复制此文件为 .env 用于本地开发
# cp .env.local.example .env

# ============================================
# 服务器角色配置
# ============================================
# 本地开发 = 主服务器（与香港服务器功能相同）
IS_MAIN_SERVER=true

# ============================================
# 数据源控制
# ============================================
# 本地开发启用4个第三方数据源
ENABLE_OTHER_SOURCES=true

# 本地无法测试PlayNow（需要加拿大IP）
ENABLE_PLAYNOW=false

# ============================================
# 数据库配置（阿里云RDS）
# ============================================
# 主库（写）
WRITE_DB_HOST=rm-bp14172o6ehyk82g0vo.mysql.rds.aliyuncs.com
WRITE_DB_PORT=3306
WRITE_DB_NAME=new_api
WRITE_DB_USER=new_api
WRITE_DB_PASSWORD=04By0302

# 从库（读）
READ_DB_HOST=rm-bp119pgkr2vs02t18go.mysql.rds.aliyuncs.com
READ_DB_PORT=3306
READ_DB_NAME=new_api
READ_DB_USER=new_api
READ_DB_PASSWORD=04By0302

# Prisma连接字符串
DATABASE_URL="mysql://new_api:04By0302@rm-bp14172o6ehyk82g0vo.mysql.rds.aliyuncs.com:3306/new_api"

# ============================================
# 数据库连接池配置（本地开发专用）
# ============================================
# 重要：本地开发使用最小连接数，避免占满数据库连接池
DB_CONNECT_TIMEOUT=60
DB_SOCKET_TIMEOUT=120
DB_POOL_TIMEOUT=120
WRITE_DB_CONNECTION_LIMIT=2
READ_DB_CONNECTION_LIMIT=5

# ============================================
# Redis配置（阿里云Redis）
# ============================================
REDIS_HOST=r-bp1m85dvrgmkgmdipfpd.redis.rds.aliyuncs.com
REDIS_PORT=6379
REDIS_PASSWORD=04By0302
REDIS_CONNECT_TIMEOUT=30000
REDIS_COMMAND_TIMEOUT=15000
REDIS_KEEPALIVE=30000

# ============================================
# 应用配置
# ============================================
NODE_ENV=development
LOG_LEVEL=debug
OUTPUT_DIR=./output
TZ=Asia/Shanghai

# ============================================
# AI配置（DeepSeek）
# ============================================
AI_API_KEY=sk-dab902d41bbf4d32843e0b718ee3ebab
AI_API_URL=https://api.deepseek.com/v1/chat/completions
AI_MODEL=deepseek-chat
AI_TIMEOUT=30000

# ============================================
# 缓存配置
# ============================================
CACHE_LOCK_TTL=3
CACHE_SEEN_TTL=3600
CACHE_DATA_TTL=180
CACHE_WINRATE_TTL=300

# ============================================
# 重试配置
# ============================================
RETRY_MAX_ATTEMPTS=3
RETRY_INITIAL_DELAY=1000
RETRY_MAX_DELAY=10000

# ============================================
# AI预测配置
# ============================================
PREDICT_GROUP_DELAY=2000
PREDICT_LOCK_TTL=300

# ============================================
# 限流配置
# ============================================
RATE_LIMIT_API_MAX=120
RATE_LIMIT_STRICT_MAX=30
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_BLACKLIST_DURATION=1800

# ============================================
# 性能阈值配置
# ============================================
PERF_API_MAX_LATENCY=50
PERF_FETCHER_MAX_DELAY=2000
PERF_DB_MAX_QUERY_TIME=20
